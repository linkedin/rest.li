<!DOCTYPE html>
<html lang="en">

  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0"/>

    <title>Data-FAQ</title>
    <meta name="description" content="A REST framework for building scalable service architectures using dynamic discovery and simple asynchronous APIs" />

    <link rel="icon"
      type="image/png"
      href="/images/icon_pegasus.png">
  
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" type="text/css" media="screen,projection" href="/assets/materialize.css" />
    <link rel="stylesheet" type="text/css" media="screen,projection" href="/assets/main.css">
    <link rel="canonical" href="http://localhost:4000/Data-FAQ" />
    <link rel="alternate" type="application/rss+xml" title="rest.li" href="/feed.xml" />
  
    
</head>


  <body>

    <nav class="dark-grey" role="navigation">
    <div class="nav-wrapper container"><a id="logo-container" class="brand-logo" href="/">Rest.li</a>


          <ul class="right hide-on-med-and-down">
               
      
        <li>
          <a href="/rest.li/get_started/quick_start" >
            Getting Started
          </a>
        </li>
        
        <li>
          <a href="/rest.li/user_guide/server_architecture" >
            User guide
          </a>
        </li>
        
        <li>
          <a href="/rest.li/spec/protocol" >
            API reference
          </a>
        </li>
        
        <li>
          <a href="/rest.li/contribute/howto" >
            Contribute
          </a>
        </li>
        
          </ul>


      <a href="#" data-activates="nav-mobile" class="button-collapse"><i class="material-icons">menu</i></a>
    </div>
</nav>


        <div class="container">
        <div class="row">
                <div class="col s12 m4 l3"> 
               
                    
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">User Guide</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/user_guide/server_architecture">Rest.li Architecture</a></li>
                       
                         <li><a href="/rest.li/user_guide/restli_server">Rest.li Server</a></li>
                       
                         <li><a href="/rest.li/user_guide/restli_client">Rest.li Client Framework</a></li>
                       
                         <li><a href="/rest.li/Components">Components</a></li>
                       
                         <li><a href="/rest.li/Asynchronous-Servers-and-Clients-in-Rest_li">Asynchronous-Servers-and-Clients-in-Rest.li</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Modeling Resources</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/DATA-Data-Schema-and-Templates">DATA-Data-Schema-and-Templates</a></li>
                       
                         <li><a href="/rest.li/modeling/modeling">Modeling Resources</a></li>
                       
                         <li><a href="/rest.li/modeling/compatibiltiy_check">Snapshots and Resource Compatibility Checking</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Main concepts</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Rest_li-Filters">Filters</a></li>
                       
                         <li><a href="/rest.li/Projections">Projections</a></li>
                       
                         <li><a href="/rest.li/Validation-in-Rest_li">Validation</a></li>
                       
                         <li><a href="/rest.li/Attachment-Streaming">Attachment-Streaming</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Mutli-language</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Scala-Integration">Scala-Integration</a></li>
                       
                         <li><a href="https://github.com/mchen07/restli-csharp">C#</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">Testing</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Writing-unit-tests-for-Rest_li-clients-and-servers">Writing unit tests</a></li>
                       
                        </ul>
                     </ul>
                        
                   
                    
                     <ul class="nav_items">
                        <li><span class="nav_sub-title">How to</span></li>
                        <ul>
                       
                         <li><a href="/rest.li/Send-Rest_li-Request-Query-In-Request-Body">Send Rest.li request query in request body</a></li>
                       
                         <li><a href="/rest.li/How-to-use-projections-in-Java">How to use projections</a></li>
                       
                         <li><a href="/rest.li/How_To:Rest_li_Avro_conversions">Rest.li to Avro conversion</a></li>
                       
                         <li><a href="/rest.li/Compression">Compression</a></li>
                       
                         <li><a href="/rest.li/Rest_li-2_x-upgrade-instructions">How to migrate to Rest.li 2.x</a></li>
                       
                         <li><a href="/rest.li/Data-FAQ">FAQ</a></li>
                       
                        </ul>
                     </ul>
                        
                    </div>
                     <div class="markdown-body col s12 m3 l9">
                            <h4 id="how-do-i-validate-a-record-with-default-values-filled-in"><strong>How do I validate a record with default values filled in?</strong></h4>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Foo</span> <span class="n">foo</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Foo</span><span class="o">();</span>  
<span class="n">ValidationResult</span> <span class="n">result</span> <span class="o">=</span> <span class="n">ValidateDataAgainstSchema</span><span class="o">.</span><span class="na">validate</span><span class="o">(</span><span class="n">foo</span><span class="o">.</span><span class="na">data</span><span class="o">(),</span>
<span class="n">foo</span><span class="o">.</span><span class="na">schema</span><span class="o">(),</span> <span class="k">new</span>
<span class="n">ValidationOptions</span><span class="o">(</span><span class="n">RequiredMode</span><span class="o">.</span><span class="na">FIXUP_ABSENT_WITH_DEFAULT</span><span class="o">));</span>  
<span class="k">assert</span><span class="o">(</span><span class="n">result</span><span class="o">.</span><span class="na">isValid</span><span class="o">());</span>  
</code></pre></div></div>

<p>This will fail if the underlying data is read-only and default values
cannot be set for absent fields.</p>

<p>This will also work for partially filled in records. It will only add
default values to fields that are absent.</p>

<h4 id="how-do-i-convert-a-pegasus-data-schema-to-an-avro-data-schema">How do I convert a Pegasus data schema to an Avro data schema</h4>

<p>It requires the data-avro module, or data-avro-*.jar.</p>

<p>At runtime, use:</p>

<div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Foo</span> <span class="n">foo</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Foo</span><span class="o">();</span>  
<span class="n">DataSchema</span> <span class="n">pegasusSchema</span> <span class="o">=</span> <span class="n">foo</span><span class="o">.</span><span class="na">schema</span><span class="o">();</span>  
<span class="n">org</span><span class="o">.</span><span class="na">apache</span><span class="o">.</span><span class="na">avro</span><span class="o">.</span><span class="na">Schema</span> <span class="n">avroSchema</span> <span class="o">=</span>
<span class="n">SchemaTranslator</span><span class="o">.</span><span class="na">dataToAvroSchema</span><span class="o">(</span><span class="n">pegasusSchema</span><span class="o">);</span>  
<span class="n">String</span> <span class="n">avsoSchemaInJson</span> <span class="o">=</span> <span class="n">avroSchema</span><span class="o">.</span><span class="na">toString</span><span class="o">();</span>  
</code></pre></div></div>

<p>From the command line, to create text files with Avro schema from pdsc
files (version 0.17.1 or higher):</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>```# syntax:
# java [-Dgenerator.resolver.path=&lt;path&gt;] com.linkedin.data.avro.AvroSchemaGenerator &lt;targetDir&gt; [&lt;pdscFile|schemaFullName&gt;]...
java -Dgenerator.resolver.path=src/main/pegasus com.linkedin.data.avro.generator.AvroSchemaGenerator ../build/main/codegen/avro src/main/pegasus/com/linkedin/foo/*.pdsc
# or
java -Dgenerator.resolver.path=src/main/pegasus com.linkedin.data.avro.generator.AvroSchemaGenerator ../build/main/codegen/avro com.linkedin.foo.Foo
```
</code></pre></div></div>

<p>Classpath must be setup to include data-avro.jar and its dependencies.</p>

<h4 id="how-do-i-use-a-data-type-embedded-inside-a-pdsc-file">How do I use a data type embedded inside a pdsc file?</h4>

<p>You may experience errors, such as the
    following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>```Type cannot be resolved: 1,1: "a.b.D" cannot be resolved.```
</code></pre></div></div>

<p>when <code class="highlighter-rouge">a.b.D</code>’s definition is embedded in another type, for
example, <code class="highlighter-rouge">a.b.C</code>.</p>

<p>Embedded data types do not have their own pdsc file. As a result, such
data type can only be referenced within the containing pdsc file. It can
not be referenced externally. To change this behavior, pull out the
definition of the internal type to a separate pdsc file.</p>

<p>Internally, this behavior is due to reason that the schema parser
references the data types by filenames. pdsc file for <code class="highlighter-rouge">a.b.C</code>
should be expected at <code class="highlighter-rouge">pegasus/a/b/C.pdsc</code>. Since Rest.li
does not prefix the containing data type’s name to the embedded type’s
name, when code&gt;a.b.D<code class="highlighter-rouge">is embedded in</code>C.pdsc<code class="highlighter-rouge">, the
schema parser will not be able to find
</code>pegasus/a/b/D.pdsc```.</p>

<h4 id="why-is-my-java-8-build-generating-all-sorts-of-javadoc-warningserrors-due-to-doclint">Why is my Java 8 build generating all sorts of Javadoc warnings/errors due to doclint?</h4>

<p>When using Java 8, you may experience build failures due to the
following:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>```[error] /home/myuser/data-template/src/main/codegen/com/linkedin/PegasusFormSchema.java:192: error: malformed HTML
* return type: java.util.Set&lt;java.lang.Integer&gt;
[error] /home/myuser/data-template/src/main/codegen/com/linkedin/PegasusFormSchema.java:192: error: bad use of '&gt;'
* return type: java.util.Set&lt;java.lang.Integer&gt;
```
</code></pre></div></div>

<p>The root cause is incorrectly formatted string values for anything
within the <code class="highlighter-rouge">doc</code> or <code class="highlighter-rouge">symbolDocs</code> attributes within your pdscs. Due to
the addition of doclint in JDK8, anything under the doc or symbolDocs
attribute must be W3C HTML 4.01 compliant. This is because the contents
of this string will appear as Javadocs in the generated Java ‘data
template’ classes later. Please take this into consideration when
writing your documentation.</p>

<p>The alternative is to disable doclint altogether:</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>```  
if (JavaVersion.current().isJava8Compatible()) {
  allprojects {
    tasks.withType(Javadoc) {
      options.addStringOption('Xdoclint:none', '-quiet')
    }
  }
}
```
</code></pre></div></div>

<p>More details on doclint can be found here: <a href="http://stackoverflow.com/questions/22528767/jdk8-and-javadoc-has-become-very-strict">Javadoc has become very
strict</a></p>

<p>More details on <code class="highlighter-rouge">doc</code> and <code class="highlighter-rouge">symbolDocs</code> can be found here: <a href="DATA-Data-Schema-and-Templates">Data Schemas
and
Templates</a></p>

<h4 id="how-does-restli-full-update-method-work-with-schema-evolution">How does rest.li full update method work with schema evolution?</h4>

<p>There is a potential pitfall to be aware of. Consider the following
scenario:</p>

<ol>
  <li>Suppose a schema begins on version 0 with a single optional field A.
We write a client that sends an update request with the field A
populated.</li>
  <li>At some point, we add an optional field B in version 1.</li>
  <li>Our old client still sends a request with A populated, but it is not
clear how to interpret its request. From the server’s perspective,
we cannot distinguish a new client that wants to null out field B
(e.g. schema version 1) vs. a client that is not aware of field B
(e.g. version 0).</li>
</ol>

                     </div>
                   </div>
</div>



      <footer class="page-footer">
    <div class="container">
      <div class="row">
        <div class="col s6">
          <h5>Rest.li</h5>
          <p class="text-lighten-4">Rest.li is an open source REST framework for building robust, scalable RESTful architectures using type-safe bindings and asynchronous, non-blocking IO. Rest.li fills a niche for applying RESTful principles at scale with an end-to-end developer workflow for building REST APIs, which promotes clean REST practices, uniform interface design and consistent data modeling.</p>
        </div>
        <div class="col s5 offset-s1">
          <h5 class="black-text">Community</h5>
          <ul>
              <li>Github <a class="" href="https://github.com/linkedin/rest.li">Rest.li</a></li>
              <li>Linkedin <a class="" href="http://www.linkedin.com/groups/Restli-4855943">Rest.li Group</a></li>
            <li>Follow us on twitter: <a class="" href="https://twitter.com/rest_li"> @rest_li</a></li>
            <li>Issue Tracking: <a class="" href="https://github.com/linkedin/rest.li/issues">github issue tracking</a></li>
          </ul>
        </div>
      </div>
    </div>
    <div class="footer-copyright">
        <div class="container">
            <div>
                <span style="text-align: right; float: left">
                Copyright © 2018. Powered by <a target="_blank" href="http://jekyllrb.com/" class="black-text text-lighten-3">Jekyll</a>
                </span> 
            </div>
        </div>  
    </div>
</footer>
      
    <!--  Scripts-->                                                                               
<script src="/js/jquery.min.js"></script>
<script src="/js/materialize.min.js"></script>
<script src="/js/init.js"></script>

  </body>

</html>
